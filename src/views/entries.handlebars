<head>
    <link rel="stylesheet" href="/css/entries.css">
</head>

<script>
    (async () => {
        const token = sessionStorage.getItem('token');

        const res = await fetch('/api/auth/verify', {
            headers: { Authorization: token },
        });

        if (!res.ok) {
            return window.location.assign("/login")
        }
    })()
</script>

<div>
    <div id="entriesHeader">
        <h3>Meine Einträge</h3>
        <button class="p-2 px-4 bg-neutral-800 hover:bg-neutral-950 text-white rounded font-normal" href="#" onClick="location.href='/edit'">+ Neuer Eintrag</button>
    </div>

    <div id="nav">

    </div>

    <div id="entryContainer">
        <script>
            (async () => {
                const token = sessionStorage.getItem('token');

                const res = await fetch('/api/auth/verify', {
                    headers: { Authorization: token },
                });

                if (!res.ok) {
                    return window.location.assign("/login")
                }

                const resList = await fetch('/api/entry/list', {
                    headers: { Authorization: token },
                    method: "get"
                });

                if (!resList.ok){
                    return window.location.assign("/login")
                }
                const list = await resList.json();

                console.log(list);

                const entryContainer = document.getElementById("entryContainer");
                for (let i = 0; i < list.length; i++){
                    entryContainer.innerHTML += `<div class="entryItem">
                                                    <a href="/entries">${list[i].title}</a>
                                                    <button class="p-2 px-4 bg-neutral-800 hover:bg-neutral-950 text-white rounded font-normal" href="#" onclick="showDelete('popupDelete', ${list[i].entryID})" data-id="${list[i].entryID}">Löschen</button>
                                                </div>`
                }
                entryContainer.classList.replace("hidden", "flex")
                
            })()
            

        </script>
    </div>

</div>

